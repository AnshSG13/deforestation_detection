True
[0]
Total training samples (base count): 73
Total validation  samples (base count): 9
initialize network with normal
cuda:0
================ (Thu Apr 17 21:31:55 2025) ================
gpu_ids: [0] project_name: CD_ChangeFormerV6_deforestation_b16_lr0.0001_adamw_train_test_200_linear_ce_multi_train_True_multi_infer_False_shuffle_AB_False_embed_dim_256 checkpoint_root: checkpoints vis_root: vis num_workers: 1 dataset: CDDataset data_name: deforestation batch_size: 16 split: train split_val: test img_size: 256 shuffle_AB: False n_class: 2 embed_dim: 256 pretrain: None multi_scale_train: True multi_scale_infer: False multi_pred_weights: [0.5, 0.5, 0.5, 0.8, 1.0] net_G: ChangeFormerV6 loss: ce optimizer: adamw lr: 0.0001 max_epochs: 5 lr_policy: linear lr_decay_iters: 100 checkpoint_dir: checkpoints/CD_ChangeFormerV6_deforestation_b16_lr0.0001_adamw_train_test_200_linear_ce_multi_train_True_multi_infer_False_shuffle_AB_False_embed_dim_256 vis_dir: vis/CD_ChangeFormerV6_deforestation_b16_lr0.0001_adamw_train_test_200_linear_ce_multi_train_True_multi_infer_False_shuffle_AB_False_embed_dim_256 

training from scratch...


lr: 0.0001000
 
  0%|          | 0/5 [00:00<?, ?it/s]/work/pi_jaimedavila_umass_edu/asadhgauri_umass_edu/.conda/envs/changeformer_new/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
 20%|██        | 1/5 [00:06<00:24,  6.13s/it] 40%|████      | 2/5 [01:26<02:29, 49.94s/it] 60%|██████    | 3/5 [02:46<02:07, 63.79s/it] 80%|████████  | 4/5 [04:07<01:10, 70.35s/it]100%|██████████| 5/5 [04:10<00:00, 46.04s/it]100%|██████████| 5/5 [04:10<00:00, 50.08s/it]Is_training: True. [0,4][1,5], imps: 5.88, est: 0.28h, G_loss: 16.71185, running_mf1: 0.39984
Is_training: True. Epoch 0 / 4, epoch_mF1= 0.43243
acc: 0.67985 miou: 0.35320 mf1: 0.43243 iou_0: 0.67668 iou_1: 0.02971 F1_0: 0.80717 F1_1: 0.05770 precision_0: 0.96969 precision_1: 0.03172 recall_0: 0.69130 recall_1: 0.31883 

Begin evaluation...
Validation set size: 9 samples, 1 batches

  batch 0:   bs=9   valid_pixels=282489   raw_loss=0.539543
Is_training: False. Epoch 0 / 4, epoch_mF1= 0.51826
acc: 0.91335 miou: 0.47788 mf1: 0.51826 iou_0: 0.91302 iou_1: 0.04275 F1_0: 0.95453 F1_1: 0.08199 precision_0: 0.94032 precision_1: 0.11797 recall_0: 0.96917 recall_1: 0.06282 

Latest model updated. Epoch_acc=0.5183, Historical_best_acc=0.0000 (at epoch 0)

**********Best model updated!

lr: 0.0000833
 
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [01:21<05:24, 81.20s/it] 40%|████      | 2/5 [02:41<04:02, 80.81s/it] 60%|██████    | 3/5 [04:02<02:41, 80.64s/it] 80%|████████  | 4/5 [05:22<01:20, 80.51s/it]100%|██████████| 5/5 [05:25<00:00, 52.56s/it]100%|██████████| 5/5 [05:25<00:00, 65.11s/it]Is_training: True. [1,4][1,5], imps: 4.31, est: 0.30h, G_loss: 11.52319, running_mf1: 0.69699
Is_training: True. Epoch 1 / 4, epoch_mF1= 0.55320
acc: 0.88742 miou: 0.48855 mf1: 0.55320 iou_0: 0.88614 iou_1: 0.09097 F1_0: 0.93963 F1_1: 0.16677 precision_0: 0.97825 precision_1: 0.10795 recall_0: 0.90395 recall_1: 0.36645 

Begin evaluation...
Validation set size: 9 samples, 1 batches

  batch 0:   bs=9   valid_pixels=282489   raw_loss=0.512595
Is_training: False. Epoch 1 / 4, epoch_mF1= 0.53529
acc: 0.86342 miou: 0.46993 mf1: 0.53529 iou_0: 0.86182 iou_1: 0.07804 F1_0: 0.92578 F1_1: 0.14479 precision_0: 0.94453 precision_1: 0.11784 recall_0: 0.90777 recall_1: 0.18772 

Latest model updated. Epoch_acc=0.5353, Historical_best_acc=0.5183 (at epoch 0)

**********Best model updated!

lr: 0.0000667
 
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [01:21<05:24, 81.23s/it] 40%|████      | 2/5 [02:41<04:02, 80.87s/it] 60%|██████    | 3/5 [04:02<02:41, 80.64s/it] 80%|████████  | 4/5 [05:22<01:20, 80.52s/it]100%|██████████| 5/5 [05:25<00:00, 52.54s/it]100%|██████████| 5/5 [05:25<00:00, 65.11s/it]Is_training: True. [2,4][1,5], imps: 4.12, est: 0.22h, G_loss: 11.09603, running_mf1: 0.51439
Is_training: True. Epoch 2 / 4, epoch_mF1= 0.62448
acc: 0.95259 miou: 0.55528 mf1: 0.62448 iou_0: 0.95217 iou_1: 0.15839 F1_0: 0.97550 F1_1: 0.27347 precision_0: 0.97740 precision_1: 0.25856 recall_0: 0.97360 recall_1: 0.29020 

Begin evaluation...
Validation set size: 9 samples, 1 batches

  batch 0:   bs=9   valid_pixels=282489   raw_loss=0.330017
Is_training: False. Epoch 2 / 4, epoch_mF1= 0.48602
acc: 0.93736 miou: 0.46977 mf1: 0.48602 iou_0: 0.93735 iou_1: 0.00220 F1_0: 0.96766 F1_1: 0.00439 precision_0: 0.93847 precision_1: 0.10372 recall_0: 0.99873 recall_1: 0.00224 

Latest model updated. Epoch_acc=0.4860, Historical_best_acc=0.5353 (at epoch 1)

lr: 0.0000500
 
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [01:21<05:24, 81.13s/it] 40%|████      | 2/5 [02:41<04:02, 80.79s/it] 60%|██████    | 3/5 [04:02<02:41, 80.61s/it] 80%|████████  | 4/5 [05:22<01:20, 80.50s/it]100%|██████████| 5/5 [05:25<00:00, 52.56s/it]100%|██████████| 5/5 [05:25<00:00, 65.10s/it]Is_training: True. [3,4][1,5], imps: 4.05, est: 0.14h, G_loss: 9.09468, running_mf1: 0.49307
Is_training: True. Epoch 3 / 4, epoch_mF1= 0.56392
acc: 0.96851 miou: 0.52297 mf1: 0.56392 iou_0: 0.96843 iou_1: 0.07751 F1_0: 0.98396 F1_1: 0.14388 precision_0: 0.97173 precision_1: 0.43846 recall_0: 0.99650 recall_1: 0.08606 

Begin evaluation...
Validation set size: 9 samples, 1 batches

  batch 0:   bs=9   valid_pixels=282489   raw_loss=0.269878
Is_training: False. Epoch 3 / 4, epoch_mF1= 0.48407
acc: 0.93826 miou: 0.46913 mf1: 0.48407 iou_0: 0.93826 iou_1: 0.00000 F1_0: 0.96814 F1_1: 0.00000 precision_0: 0.93840 precision_1: 0.00000 recall_0: 0.99983 recall_1: 0.00000 

Latest model updated. Epoch_acc=0.4841, Historical_best_acc=0.5353 (at epoch 1)

lr: 0.0000333
 
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [01:21<05:24, 81.21s/it] 40%|████      | 2/5 [02:41<04:02, 80.88s/it] 60%|██████    | 3/5 [04:02<02:41, 80.66s/it] 80%|████████  | 4/5 [05:22<01:20, 80.59s/it]100%|██████████| 5/5 [05:25<00:00, 52.61s/it]100%|██████████| 5/5 [05:25<00:00, 65.16s/it]Is_training: True. [4,4][1,5], imps: 4.02, est: 0.05h, G_loss: 14.57716, running_mf1: 0.63859
Is_training: True. Epoch 4 / 4, epoch_mF1= 0.54246
acc: 0.96936 miou: 0.51111 mf1: 0.54246 iou_0: 0.96931 iou_1: 0.05291 F1_0: 0.98442 F1_1: 0.10050 precision_0: 0.97087 precision_1: 0.51589 recall_0: 0.99834 recall_1: 0.05567 

Begin evaluation...
Validation set size: 9 samples, 1 batches

  batch 0:   bs=9   valid_pixels=282489   raw_loss=0.247034
Is_training: False. Epoch 4 / 4, epoch_mF1= 0.48650
acc: 0.93817 miou: 0.47031 mf1: 0.48650 iou_0: 0.93816 iou_1: 0.00246 F1_0: 0.96809 F1_1: 0.00490 precision_0: 0.93853 precision_1: 0.27742 recall_0: 0.99958 recall_1: 0.00247 

Latest model updated. Epoch_acc=0.4865, Historical_best_acc=0.5353 (at epoch 1)

Training complete. Curves saved to checkpoints/CD_ChangeFormerV6_deforestation_b16_lr0.0001_adamw_train_test_200_linear_ce_multi_train_True_multi_infer_False_shuffle_AB_False_embed_dim_256
initialize network with normal
cuda:0
================ (Thu Apr 17 21:58:05 2025) ================
gpu_ids: [0] project_name: CD_ChangeFormerV6_deforestation_b16_lr0.0001_adamw_train_test_200_linear_ce_multi_train_True_multi_infer_False_shuffle_AB_False_embed_dim_256 checkpoint_root: checkpoints vis_root: vis num_workers: 1 dataset: CDDataset data_name: deforestation batch_size: 16 split: train split_val: test img_size: 256 shuffle_AB: False n_class: 2 embed_dim: 256 pretrain: None multi_scale_train: True multi_scale_infer: False multi_pred_weights: [0.5, 0.5, 0.5, 0.8, 1.0] net_G: ChangeFormerV6 loss: ce optimizer: adamw lr: 0.0001 max_epochs: 5 lr_policy: linear lr_decay_iters: 100 checkpoint_dir: checkpoints/CD_ChangeFormerV6_deforestation_b16_lr0.0001_adamw_train_test_200_linear_ce_multi_train_True_multi_infer_False_shuffle_AB_False_embed_dim_256 vis_dir: vis/CD_ChangeFormerV6_deforestation_b16_lr0.0001_adamw_train_test_200_linear_ce_multi_train_True_multi_infer_False_shuffle_AB_False_embed_dim_256 loading last checkpoint...
Eval Historical_best_acc = 0.5353 (at epoch 1)

Begin evaluation...
/work/pi_jaimedavila_umass_edu/asadhgauri_umass_edu/.conda/envs/changeformer_new/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/work/pi_jaimedavila_umass_edu/asadhgauri_umass_edu/.conda/envs/changeformer_new/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
Is_training: False. [1,2],  running_mf1: 0.46912
acc: 0.90084 miou: 0.45164 mf1: 0.47637 iou_0: 0.90081 iou_1: 0.00247 F1_0: 0.94782 F1_1: 0.00493 precision_0: 0.99285 precision_1: 0.00264 recall_0: 0.90670 recall_1: 0.03648 

